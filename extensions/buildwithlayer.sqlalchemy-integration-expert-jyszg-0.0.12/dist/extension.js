(()=>{"use strict";var t={300:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=r(n(896));function o(t,e){const n=e.split("/").pop();let r=a.default.readFileSync(e);t.append("files",new Blob([r]),n)}function i(t,e){return{...e,value:t.split("/").pop()}}e.default=class{apiKey="379dae40-f6e9-4c57-adeb-18372a8e3ced";environment="production";customer;constructor(){this.getCustomerName().then((t=>{this.customer=t}))}getBaseUrl(){return"development"===this.environment?"http://localhost":"staging"===this.environment?"https://api.staging.buildwithlayer.com":"https://api.buildwithlayer.com"}headers(){const t=new Headers;return t.set("Layer-Api-Key",this.apiKey),t}getHeaders(){const t=this.headers();return t.set("Accept","application/json"),t}getRequest(t){return new Request(`${this.getBaseUrl()}/${t}`,{method:"GET",headers:this.getHeaders()})}postFormRequest(t,e){const n=this.headers();return n.delete("Content-Type"),new Request(`${this.getBaseUrl()}/${t}`,{method:"POST",headers:n,body:e})}async getCustomerName(){return fetch(this.getRequest("customers/")).then((t=>t.json())).then((t=>t)).then((t=>t.company_name))}async getPrompt(t,e=[],n=[],r){const a=new FormData;return a.append("query",t),e.map((t=>JSON.stringify(t))).forEach(((t,e)=>{a.append("history",t)})),a.append("token_limit",r.toString()),n.map((t=>{const e=(n=t.value)&&"object"==typeof n&&n.path&&"string"==typeof n.path?n.path:"";var n;if(e)return o(a,e),i(e,t);const r=function(t){return t&&"object"==typeof t&&t.uri&&"string"==typeof t.uri.path?t.uri.path:""}(t.value);return r?(o(a,r),i(r,t)):t})).map((t=>JSON.stringify(t))).forEach(((t,e)=>{a.append("references",t)})),fetch(this.postFormRequest("chat/vscode",a)).then((t=>t.json())).then((t=>t.messages)).catch((t=>(console.error(t),[{role:"assistant",content:"An error occurred while fetching the prompt."}])))}}},999:function(t,e,n){var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(e,n);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,a)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return a(e,t),e},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.FEEDBACK_COMMAND_ID=void 0;const s=o(n(398)),c=i(n(300));e.FEEDBACK_COMMAND_ID="codewithlayer.feedback";const d={vendor:"copilot",family:"gpt-4o"},u=new c.default;e.default=async(t,e,n,r)=>{n.progress("Thinking...");const a=t.references.map((t=>{const e=t;return{...e,name:e.name||"unknown"}}));if("feedback"===t.command)n.markdown("To provide feedback, please navigate to our [Feedback Form](https://chatwithmui.featurebase.app/).");else{const[o]=await s.lm.selectChatModels(d),i=o.maxInputTokens,c=e.history?.map((t=>"prompt"in t?{role:"user",content:t.prompt}:"response"in t?{role:"assistant",content:t.response.find((t=>t instanceof s.ChatResponseMarkdownPart))?.value.value||""}:void 0)).filter((t=>void 0!==t))||[],l=await u.getPrompt(t.prompt,c,a,i-150),p=(t=>t.map((t=>{switch(t.role){case"assistant":case"system":return s.LanguageModelChatMessage.Assistant(t.content);case"user":return s.LanguageModelChatMessage.User(t.content);default:throw new Error(`Unknown role: ${t.role}`)}})))(l),h=l.map((t=>t.citation)).filter((t=>null!=t));Array.from(new Map(h.map((t=>[t.url,t]))).values()).forEach((t=>{void 0===t.url||null===t.url?n.reference(s.Uri.parse(`my:${t.name}`)):n.reference(s.Uri.parse(`${t.url}`),new s.ThemeIcon("link"))})),l.map((t=>t.reference)).filter((t=>void 0!==t)).forEach((t=>{t&&n.reference(s.Uri.parse(`my:${t.name}`))}));const m=await o.sendRequest(p,{},r);for await(const t of m.text)n.markdown(t)}return{errorDetails:undefined,metadata:undefined}}},265:function(t,e,n){var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(e,n);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,a)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return a(e,t),e},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.activate=function(t){let e,n=s.commands.registerCommand(d+".resetChat",(()=>{e&&e.webview.postMessage({type:"resetChat"})})),r=s.commands.registerCommand(d+".disableSidebar",(async()=>{await s.workspace.getConfiguration(d).update("sidebarChatDisabled",!0,s.ConfigurationTarget.Global),s.commands.executeCommand("setContext",d+".sidebarVisible",!1)})),a=s.commands.registerCommand(d+".enableSidebar",(async()=>{await s.workspace.getConfiguration(d).update("sidebarChatDisabled",!1,s.ConfigurationTarget.Global),s.commands.executeCommand("setContext",d+".sidebarVisible",!0)}));const o=s.chat.createChatParticipant(d,c.default);o.iconPath=s.Uri.joinPath(t.extensionUri,"icon.png"),t.subscriptions.push(o,n,r,a);class i{extensionUri;_subscriptions;static viewType="sqlalchemy-integration-expert-jYSzG.Webview";constructor(t,e){this.extensionUri=t,this._subscriptions=e}resolveWebviewView(t,n,r){e=t,t.webview.options={enableScripts:!0,localResourceRoots:[this.extensionUri]},t.webview.html=this.getHtmlForWebview(t.webview),t.webview.onDidReceiveMessage((t=>{"copy"!==t.command||s.env.clipboard.writeText(t.text).then((()=>{s.window.showInformationMessage("Text copied to clipboard")}))}),void 0,this._subscriptions)}getHtmlForWebview(t){return'\n\t\t  <!DOCTYPE html>\n\t\t  <html lang="en">\n\t\t  <head>\n\t\t\t<meta charset="UTF-8">\n\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t\t\t<style>\n\t\t\t  body, html {\n\t\t\t\tmargin: 0;\n\t\t\t\tpadding: 0;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tbackground-color: white;\n\t\t\t\toverflow: hidden;\n\t\t\t  }\n\t\t\t  iframe {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tborder: none;\n\t\t\t  }\n\t\t\t</style>\n\t\t\t<title>My Webview</title>\n\t\t  </head>\n\t\t  <body>\n\t\t\t  <script>\n\t\t\t\t  const vscode = acquireVsCodeApi();\n\t  \n\t\t\t\t  window.addEventListener("message", (event) => {\n\t\t\t\t\t  if (event.data.type === "copy") {\n\t\t\t\t\t\t  vscode.postMessage({\n\t\t\t\t\t\t\t  command: "copy",\n\t\t\t\t\t\t\t  text: event.data.text\n\t\t\t\t\t\t  })\n\t\t\t\t\t  }\n\t\t\t\t  });\n\n\t\t\t\t  window.addEventListener("message", (event) => {\n\t\t\t\t\t  if (event.data.type === "resetChat") {\n\t\t\t\t\t\tdocument.getElementById("iframe").contentWindow.postMessage({type: "resetChat"}, "*");\n\t\t\t\t\t  }\n\t\t\t\t  });\n\t  \n\t\t\t\t  window.addEventListener("message", (event) => {\n\t\t\t\t\t  if (event.data.type === "paste") {\n\t\t\t\t\t\t  navigator.clipboard.readText().then((clipboardText) => {\n\t\t\t\t\t\t\t  document.getElementById("iframe").contentWindow.postMessage({type: "clipboard", text: clipboardText }, "*");\n\t\t\t\t\t\t  });\n\t\t\t\t\t  }\n\t\t\t\t  });\n\t  \n\t\t\t  <\/script>\n\t\t\t<iframe id="iframe" src="https://chat-app-prod-r5uz5svela-uc.a.run.app/?apikey=379dae40-f6e9-4c57-adeb-18372a8e3ced&source=vscode" allow="clipboard-read; clipboard-write" style="background-color: #181818;"></iframe>\n\t\t  </body>\n\t\t  </html>'}}const u=new i(t.extensionUri,t.subscriptions);t.subscriptions.push(s.window.registerWebviewViewProvider(i.viewType,u));const l=s.workspace.getConfiguration(d).get("sidebarChatDisabled",!1);s.commands.executeCommand("setContext",d+".sidebarVisible",!l),s.workspace.onDidChangeConfiguration((t=>{if(console.log(t),t.affectsConfiguration(d+".sidebarChatDisabled")){const t=s.workspace.getConfiguration(d).get("sidebarChatDisabled",!1);s.commands.executeCommand("setContext",d+".sidebarVisible",!t)}}))};const s=o(n(398)),c=i(n(999)),d="sqlalchemy-integration-expert-jYSzG"},398:t=>{t.exports=require("vscode")},896:t=>{t.exports=require("fs")}},e={},n=function n(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}(265);module.exports=n})();
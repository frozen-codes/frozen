import{Ea as k,Ha as C,Ia as P,Ja as r,Jb as s,Kb as F,Lb as R,Na as v,Pa as w,c as u,d as g,g as z,k as h,r as c,xa as S,za as y}from"./chunk-PUWFO3BD.js";var A=u(z());var U=u(g());var T=u(c()),p=(0,U.createContext)(void 0),Q=({children:i})=>{let t=R();return(0,T.jsx)(p.Provider,{value:{state:t.state,submit:async d=>{await t.extensionRpc.action("submit",{answers:d})},cancel:async()=>{await t.extensionRpc.action("cancel")},openPrivacyStatement:async()=>{await t.extensionRpc.action("openPrivacyStatement")}},children:i})};var l=u(g());var e=u(c()),L=h({root:{display:"flex",flexDirection:"column",width:"800px",maxWidth:"calc(100% - 20px)","> *":{marginBottom:"15px"},padding:"10px"},title:{marginBottom:"30px"},footer:{display:"flex",justifyContent:"space-between"},buttonsContainer:{display:"flex","> *":{marginRight:"10px"}},privacyDisclaimer:{marginLeft:"auto"}}),B=()=>{let i=L(),t=(0,l.useContext)(p),[d,b]=(0,l.useState)(!0),[a,N]=(0,l.useState)({}),D=()=>{for(let o=0;o<t.state.questions.length;o++){let n=t.state.questions[o];if(n.type!=="divider"&&n?.required&&!a[n.id]){b(!0);return}}b(!1)},x=(o,n)=>{a[o]=n,N(a),D()};if(t?.state)return(0,e.jsxs)("div",{className:i.root,children:[(0,e.jsx)("h2",{style:{marginBottom:"30px"},children:t.state.title??s.userFeedback.microsoftWouldLikeYourFeedback}),t.state.subtitle&&(0,e.jsx)("p",{children:t.state.subtitle}),t.state.questions.map((o,n)=>{switch(o.type){case"nsat":return(0,e.jsx)(W,{question:o,onChange:m=>x(o.id,m)},n);case"nps":return(0,e.jsx)(q,{question:o,onChange:m=>x(o.id,m)},n);case"textarea":return(0,e.jsx)(I,{question:o,onChange:m=>x(o.id,m)},n);case"divider":return(0,e.jsx)(k,{},n);default:return}}),(0,e.jsxs)("div",{className:i.footer,children:[(0,e.jsxs)("div",{className:i.buttonsContainer,children:[(0,e.jsx)(S,{appearance:"primary",disabled:d,onClick:()=>t.submit(a),children:t.state.submitButtonText??s.userFeedback.submit}),(0,e.jsx)(S,{onClick:()=>t.cancel(),children:t.state.cancelButtonText??s.userFeedback.cancel})]}),(0,e.jsx)(C,{onClick:()=>{t.openPrivacyStatement()},children:s.userFeedback.privacyStatement})]})]})},W=({question:i,onChange:t})=>{if((0,l.useContext)(p))return(0,e.jsx)(y,{label:(0,e.jsx)(v,{weight:"bold",children:i.label??s.userFeedback.overallHowSatisfiedAreYouWithMSSQLExtension}),required:i.required??!1,children:(0,e.jsxs)(P,{layout:"horizontal-stacked",onChange:(b,a)=>t(parseInt(a.value)),children:[(0,e.jsx)(r,{value:"0",label:s.userFeedback.veryDissatisfied}),(0,e.jsx)(r,{value:"1",label:s.userFeedback.dissatisfied}),(0,e.jsx)(r,{value:"2",label:s.userFeedback.satisfied}),(0,e.jsx)(r,{value:"3",label:s.userFeedback.verySatisfied})]})})},q=({question:i,onChange:t})=>{if((0,l.useContext)(p))return(0,e.jsx)(y,{label:(0,e.jsx)(v,{weight:"bold",children:i.label}),required:i.required??!1,style:{marginBottom:"25px"},children:(0,e.jsxs)(P,{layout:"horizontal-stacked",onChange:(b,a)=>t(parseInt(a.value)),children:[(0,e.jsx)(r,{value:"0",label:(0,e.jsxs)("div",{style:{position:"relative",display:"flex",flexDirection:"column"},children:["0",(0,e.jsx)("br",{}),(0,e.jsx)(v,{style:{position:"absolute",width:"100px",top:"30px",left:"0px",fontSize:"10px"},size:200,children:s.userFeedback.notLikelyAtAll})]})}),(0,e.jsx)(r,{value:"1",label:"1"}),(0,e.jsx)(r,{value:"2",label:"2"}),(0,e.jsx)(r,{value:"3",label:"3"}),(0,e.jsx)(r,{value:"4",label:"4"}),(0,e.jsx)(r,{value:"5",label:"5"}),(0,e.jsx)(r,{value:"6",label:"6"}),(0,e.jsx)(r,{value:"7",label:"7"}),(0,e.jsx)(r,{value:"8",label:"8"}),(0,e.jsx)(r,{value:"9",label:"9"}),(0,e.jsx)(r,{value:"10",label:(0,e.jsxs)("div",{style:{position:"relative",display:"flex",flexDirection:"column"},children:["10",(0,e.jsx)("br",{}),(0,e.jsx)(v,{style:{position:"absolute",width:"max-content",top:"30px",right:"0px",fontSize:"10px"},size:200,children:s.userFeedback.extremelyLikely})]})})]})})},I=({question:i,onChange:t})=>{if((0,l.useContext)(p))return(0,e.jsx)(y,{required:i.required??!1,label:(0,e.jsx)(v,{weight:"bold",children:i.label}),hint:i.placeholder,children:(0,e.jsx)(w,{onChange:(b,a)=>t(a.value),resize:"vertical"})})};var f=u(c());A.default.createRoot(document.getElementById("root")).render((0,f.jsx)(F,{children:(0,f.jsx)(Q,{children:(0,f.jsx)(B,{})})}));
